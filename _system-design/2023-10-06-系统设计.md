---
title: 系统设计
author: Irol Zhou
date: 2023-10-06
category: system-design
layout: post
---

## 设计原则

![1727426239507](C:\Users\john\AppData\Roaming\Typora\typora-user-images\1727426239507.png)

## 高可用

### 集群多活

#### 负载均衡

- 轮询

- 随机

- IP-Hash

- 加权轮询

  - 计算所有权重的和`totalWeight`
  - 初始化每个节点的当前权重`currentWeight = 0`
  - 每次选择前，更新节点的当前权重`currentWeight += weight`，这里的weight是节点自身的权重
  - 选择`currentWeight `最大的节点，选择后更新该节点`currentWeight -= totalWeight`
  ![img](../img/加权.png)
- 插件式



### 服务保护

#### 资源隔离

**线程隔离**

Hystrix实现线程隔离，通过自定义线程池，将接口请求通过线程池进行隔离

**进程隔离**

即拆分系统为子系统进行物理隔离

#### 限流

##### 单机限流

Guava RateLimiter实现





Sentinel实现







##### 分布式限流

Sentinel实现



Redis实现



#### 熔断





#### 降级



#### 超时与重试





## 高并发

#### 服务拆分

##### 分库分表

##### 读写分离

#### 缓存

##### Redis与Mysql数据一致性

##### ORM缓存

#### 池化技术

#### 异步解耦

#### 消息队列









## 秒杀系统设计